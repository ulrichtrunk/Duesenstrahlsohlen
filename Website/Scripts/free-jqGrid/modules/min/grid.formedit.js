!function(a,b){"use strict";"function"==typeof define&&define.amd?define(["jquery","./grid.base","./jquery.fmatter","./grid.common","./grid.filter"],function(c){return b(c,a,a.document)}):"object"==typeof module&&module.exports?module.exports=function(a,c){return a||(a=window),void 0===c&&(c="undefined"!=typeof window?require("jquery"):require("jquery")(a)),require("./grid.base"),require("./jquery.fmatter"),require("./grid.common"),require("./grid.filter"),b(c,a,a.document),c}:b(jQuery,a,a.document)}("undefined"!=typeof window?window:this,function(a,b,c){"use strict";var d=a.jgrid,e=d.jqID,f=a.fn.jqGrid,g=f.getGuiStyles,h=d.mergeCssClasses,i=d.hasOneFromClasses,j=d.feedback,k=d.fullBoolFeedback,l=d.builderFmButon,m=function(a,b,c){var d;b[0]===!0&&(d="<span class='"+h("fm-button-icon",c,b[2])+"'></span>","right"===b[1]?a.addClass("fm-button-icon-right").append(d):a.addClass("fm-button-icon-left").prepend(d))},n=function(a){return g.call(this,"states."+a)},o=function(b){b.find("tr[data-rowpos]").each(function(){var b=0;a(this).children("td").each(function(){"hidden"!==a(this).css("visibility")&&b++}),b||a(this).hide()})},p=function(a){return"&nbsp;"===a||"&#160;"===a||1===a.length&&160===a.charCodeAt(0)};d.extend({searchGrid:function(b){return this.each(function(){function c(b){y("beforeShow",b)&&(a(t).data("onClose",p.onClose),d.viewModal.call(i,t,{gbox:u,jqm:p.jqModal,overlay:p.overlay,modal:p.modal,overlayClass:p.overlayClass,toTop:p.toTop,onHide:function(a){a.w.remove(),a.o&&a.o.remove()}}),y("afterShow",b))}var i=this,m=a(i),o=i.p;if(i.grid&&null!=o){var p=a.extend(!0,{drag:!0,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:!0,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,afterRedraw:null,afterChange:null,closeAfterSearch:!1,closeAfterReset:!1,closeOnEscape:!1,searchOnEnter:!1,multipleSearch:!1,multipleGroup:!1,top:0,left:0,removemodal:!0,resize:!0,width:450,height:"auto",dataheight:"auto",showQuery:!1,errorcheck:!0,sopt:null,stringResult:void 0,onClose:null,onSearch:null,onReset:null,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:!1,layer:null,operands:{eq:"=",ne:"<>",lt:"<",le:"<=",gt:">",ge:">=",bw:"LIKE",bn:"NOT LIKE",in:"IN",ni:"NOT IN",ew:"LIKE",en:"NOT LIKE",cn:"LIKE",nc:"NOT LIKE",nu:"IS NULL",nn:"IS NOT NULL"}},f.getGridRes.call(m,"search"),d.search||{},o.searching||{},b||{}),q="fbox_"+o.id,r=p.commonIconClass,s={themodal:"searchmod"+q,modalhead:"searchhd"+q,modalcontent:"searchcnt"+q,resizeAlso:q},t="#"+e(s.themodal),u=o.gBox,v=o.gView,w=a.each,x=o.postData[p.sFilter],y=function(){var b=a.makeArray(arguments);return b.unshift("Search"),b.unshift("Filter"),b.unshift(p),j.apply(i,b)},z=function(){d.hideModal(t,{gb:u,jqm:p.jqModal,onClose:p.onClose,removemodal:p.removemodal})};if("string"==typeof x&&(x=""!==a.trim(x)?a.parseJSON(x):void 0),a(t).remove(),void 0!==a(t)[0])c(a("#fbox_"+e(o.id)));else{var A=a("<div><div id='"+q+"' class='"+g.call(i,"dialog.body","searchFilter")+"' style='overflow:auto'></div></div>").insertBefore(v);"rtl"===o.direction&&A.attr("dir","rtl");var B,C,D="",E="",F=!1,G=-1,H=a.extend([],o.colModel),I=l.call(i,q+"_search",p.Find,h(r,p.findDialogIcon),"right"),J=l.call(i,q+"_reset",p.Reset,h(r,p.resetDialogIcon),"left");if(p.showQuery&&(D=l.call(i,q+"_query","Query",h(r,p.queryDialogIcon),"left")+"&#160;"),p.searchForAdditionalProperties&&w(o.additionalProperties,function(){var a="string"==typeof this?{name:this}:this;a.label||(a.label=a.name),a.isAddProp=!0,H.push(a)}),p.columns.length?(H=p.columns,G=0,B=H[0].index||H[0].name):w(H,function(a,b){if(b.label||(b.label=b.isAddProp?b.name:o.colNames[a]),!F){var c=void 0===b.search||b.search,d=b.hidden===!0,e=b.searchoptions&&b.searchoptions.searchhidden===!0;(e&&c||c&&!d)&&(F=!0,B=b.index||b.name,G=a)}}),!x&&B||p.multipleSearch===!1){var K="eq";G>=0&&H[G].searchoptions&&H[G].searchoptions.sopt?K=H[G].searchoptions.sopt[0]:p.sopt&&p.sopt.length&&(K=p.sopt[0]),x={groupOp:"AND",rules:[{field:B,op:K,data:""}]}}F=!1,p.tmplNames&&p.tmplNames.length&&(F=!0,E=p.tmplLabel,E+="<select class='ui-template'>",E+="<option value='default'>Default</option>",w(p.tmplNames,function(a,b){E+="<option value='"+a+"'>"+b+"</option>"}),E+="</select>"),C="<div class='"+g.call(i,"dialog.footer")+"'><table class='EditTable' style='border:0px none;margin-top:5px' id='"+q+"_2'><tbody><tr><td colspan='2'><hr class='"+g.call(i,"dialog.hr")+"' style='margin:1px'/></td></tr><tr><td class='EditButton EditButton-"+o.direction+"'  style='float:"+("rtl"===o.direction?"right":"left")+";'>"+J+E+"</td><td class='EditButton EditButton-"+o.direction+"'>"+D+I+"</td></tr></tbody></table></div>",q=e(q),p.gbox=u,p.height="auto",q="#"+q,a(q).jqFilter({columns:H,filter:p.loadDefaults?x:null,showQuery:p.showQuery,errorcheck:p.errorcheck,sopt:p.sopt,groupButton:p.multipleGroup,ruleButtons:p.multipleSearch,afterRedraw:p.afterRedraw,ops:p.odata,cops:o.customSortOperations,operands:p.operands,ajaxSelectOptions:o.ajaxSelectOptions,groupOps:p.groupOps,onChange:function(b,c){b.showQuery&&a(".query",c).text(c.toUserFriendlyString()),k.call(i,p.afterChange,"jqGridFilterAfterChange",a(q),p,b,c)},direction:o.direction,id:o.id}),A.append(C),F&&p.tmplFilters&&p.tmplFilters.length&&a(".ui-template",A).on("change",function(){var b=a(this).val();return"default"===b?a(q).jqFilter("addFilter",x):a(q).jqFilter("addFilter",p.tmplFilters[parseInt(b,10)]),!1}),p.multipleGroup===!0&&(p.multipleSearch=!0),y("onInitialize",a(q)),p.layer?d.createModal.call(i,s,A,p,v,a(u)[0],"#"+e(p.layer),{position:"relative"}):d.createModal.call(i,s,A,p,v,a(u)[0]),(p.searchOnEnter||p.closeOnEscape)&&a(t).keydown(function(b){var c=a(b.target);return!p.searchOnEnter||13!==b.which||c.hasClass("add-group")||c.hasClass("add-rule")||c.hasClass("delete-group")||c.hasClass("delete-rule")||c.hasClass("fm-button")&&c.is("[id$=_query]")?p.closeOnEscape&&27===b.which?(a("#"+e(s.modalhead)).find(".ui-jqdialog-titlebar-close").click(),!1):void 0:(a(q+"_search").click(),!1)}),D&&a(q+"_query").on("click",function(){return a(".queryresult",A).toggle(),!1}),void 0===p.stringResult&&(p.stringResult=p.multipleSearch),a(q+"_search").on("click",function(){var b,c={},d="",e=a(q),f=e.find(".input-elm");if(f.filter(":focus")&&(f=f.filter(":focus")),f.change(),b=e.jqFilter("filterData"),p.errorcheck&&(e[0].hideError(),p.showQuery||e.jqFilter("toSQLString"),e[0].p.error))return e[0].showError(),!1;if(p.stringResult||"local"===o.datatype){try{d=JSON.stringify(b)}catch(a){}"string"==typeof d&&(c[p.sFilter]=d,w([p.sField,p.sValue,p.sOper],function(){c[this]=""}))}else p.multipleSearch?(c[p.sFilter]=b,w([p.sField,p.sValue,p.sOper],function(){c[this]=""})):(c[p.sField]=b.rules[0].field,c[p.sValue]=b.rules[0].data,c[p.sOper]=b.rules[0].op,c[p.sFilter]="");return a.extend(o.postData,c),k.call(i,p.onSearch,"jqGridFilterSearch",o.filters)&&(o.search=!0,m.trigger("reloadGrid",[a.extend({page:1},p.reloadGridSearchOptions||{})])),p.closeAfterSearch&&z(),!1}),a(q+"_reset").on("click",function(){var b={},c=a(q);return o.search=!1,o.resetsearch=!0,p.multipleSearch===!1?b[p.sField]=b[p.sValue]=b[p.sOper]="":b[p.sFilter]="",c[0].resetFilter(),F&&a(".ui-template",A).val("default"),a.extend(o.postData,b),k.call(i,p.onReset,"jqGridFilterReset")&&m.trigger("reloadGrid",[a.extend({page:1},p.reloadGridResetOptions||{})]),p.closeAfterReset&&z(),!1}),c(a(q));var L=n.call(i,"hover");a(".fm-button:not(."+n.call(i,"disabled").split(" ").join(".")+")",A).hover(function(){a(this).addClass(L)},function(){a(this).removeClass(L)})}}})},editGridRow:function(b,c){return this.each(function(){function k(){return a(M+" > tbody > tr > td .FormElement").each(function(){var b,c,f,g,h,i,j=a(".customelement",this),k=this.name;if(j.length){if(k=j.attr("name"),c=S[k],void 0!==c&&(b=R[c],f=b.editoptions||{},a.isFunction(f.custom_value))){try{if(C[k]=f.custom_value.call(z,a("#"+e(k),M),"get"),void 0===C[k])throw"e1"}catch(a){"e1"===a?d.info_dialog.call(z,X,"function 'custom_value' "+I.msg.novalue,I.bClose):d.info_dialog.call(z,X,a.message,I.bClose)}return!0}}else switch(i=a(this)[0].type){case"checkbox":C[k]=a(this).is(":checked")?a(this).val():a(this).data("offval");break;case"select-one":C[k]=a("option:selected",this).val();break;case"select-multiple":C[k]=a(this).val(),C[k]=C[k]?C[k].join(","):"";var l=[];a("option:selected",this).each(function(b,c){l[b]=a(c).text()});break;case"date":C[k]=a(this).val(),3===String(C[k]).split("-").length&&(c=S[k],void 0!==c&&(b=R[c],g=b.formatoptions||{},h=g.newformat||G.call(A,"formatter.date.newformat"),C[k]=d.parseDate.call(A[0],"Y-m-d",C[k],h)));break;default:void 0!==i&&a.inArray(i,I.skipPostTypes)<0&&(C[k]=a(this).val())}}),!0}function q(b,c,h){var i,j=0,k=[],l=!1,m=a(c),n="<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>",q="";for(i=1;i<=h;i++)q+=n;if("_empty"!==b&&(l=f.getInd.call(A,b)),a(R).each(function(c){var f,i,n,o,r,s=this,t=s.name,u=s.editable,v=!1,w=!1,x="_empty"===b?"addForm":"editForm";switch(a.isFunction(u)&&(u=u.call(z,{rowid:b,iCol:c,iRow:l,cmName:t,cm:s,mode:x})),i=(!s.editrules||s.editrules.edithidden!==!0)&&(s.hidden===!0||"hidden"===u),String(u).toLowerCase()){case"hidden":u=!0;break;case"disabled":u=!0,v=!0;break;case"readonly":u=!0,w=!0}if("cb"!==t&&"subgrid"!==t&&u===!0&&"rn"!==t){if(l===!1)o="";else{f=a(z.rows[l].cells[c]);try{o=a.unformat.call(z,f,{rowId:b,colModel:s},c)}catch(a){o=s.edittype&&"textarea"===s.edittype?f.text():f.html()}p(o)&&(o="")}var y=a.extend({},s.editoptions||{},{id:t,name:t,rowId:b,mode:x,cm:s,iCol:c}),A=a.extend({},{elmprefix:"",elmsuffix:"",rowabove:!1,rowcontent:""},s.formoptions||{}),C=parseInt(A.rowpos,10)||j+1,D=parseInt(2*(parseInt(A.colpos,10)||1),10);if("_empty"===b&&y.defaultValue&&(o=a.isFunction(y.defaultValue)?y.defaultValue.call(z):y.defaultValue),s.edittype||(s.edittype="text"),B.autoEncodeOnEdit&&(o=d.oldDecodePostedData(o)),r=d.createEl.call(z,s.edittype,y,o,!1,a.extend({},d.ajaxOptions,B.ajaxSelectOptions||{})),(I.checkOnSubmit||I.checkOnUpdate)&&(I._savedData[t]=o),a(r).addClass("FormElement"),a.inArray(s.edittype,["text","textarea","checkbox","password","select"])>-1&&a(r).addClass(g.call(z,"dialog.dataField")),n=m.find("tr[data-rowpos="+C+"]"),A.rowabove){var E=a("<tr><td class='contentinfo' colspan='"+2*h+"'>"+A.rowcontent+"</td></tr>");m.append(E),E[0].rp=C}0===n.length&&(n=a("<tr data-rowpos='"+C+"'></tr>").addClass("FormData").attr("id","tr_"+t),a(n).append(q),m.append(n),n[0].rp=C);var F=a("td:eq("+(D-2)+")",n[0]),G=a("td:eq("+(D-1)+")",n[0]);F.html(void 0===A.label?B.colNames[c]:A.label||"&#160;"),G[p(G.html())?"html":"append"](A.elmprefix).append(r).append(A.elmsuffix),v?(F.addClass($),G.addClass($),a(r).prop("readonly",!0),a(r).prop("disabled",!0)):w&&a(r).prop("readonly",!0),"custom"===s.edittype&&a.isFunction(y.custom_value)&&y.custom_value.call(z,a("#"+e(t),J),"set",o),d.bindEv.call(z,r,y),i&&F.add(G).css("visibility","hidden"),k[j]=c,j++}}),o(m),j>0){var r=a("<tr class='FormData' style='display:none'><td class='CaptionTD'>&#160;</td><td colspan='"+(2*h-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+F+"_id' value='"+b+"'/></td></tr>");r[0].rp=j+999,m.append(r),(I.checkOnSubmit||I.checkOnUpdate)&&(I._savedData[F+"_id"]=b)}return k}function r(b,c){var g,h,i,j,k,l=0;(I.checkOnSubmit||I.checkOnUpdate)&&(I._savedData={},I._savedData[F+"_id"]=b);var m=B.colModel;if("_empty"===b)return a(m).each(function(){g=this.name,i=a.extend({},this.editoptions||{}),h=a("#"+e(g),c),h&&h.length&&null!==h[0]&&(j="","custom"===this.edittype&&a.isFunction(i.custom_value)?i.custom_value.call(z,h,"set",j):i.defaultValue?(j=a.isFunction(i.defaultValue)?i.defaultValue.call(z):i.defaultValue,"checkbox"===h[0].type?(k=j.toLowerCase(),k.search(/(false|f|0|no|n|off|undefined)/i)<0&&""!==k?(h[0].checked=!0,h[0].defaultChecked=!0,h[0].value=j):(h[0].checked=!1,h[0].defaultChecked=!1)):h.val(j)):"checkbox"===h[0].type?(h[0].checked=!1,h[0].defaultChecked=!1,j=a(h).data("offval")):h[0].type&&"select"===h[0].type.substr(0,6)?h[0].selectedIndex=0:h.val(j),(I.checkOnSubmit===!0||I.checkOnUpdate)&&(I._savedData[g]=j))}),void a("#id_g",c).val(b);var n=f.getInd.call(A,b,!0);n&&(a(n.cells).filter("td[role=gridcell]").each(function(f){var h;if(g=m[f].name,"cb"!==g&&"subgrid"!==g&&"rn"!==g&&m[f].editable===!0){try{h=a.unformat.call(z,a(this),{rowId:b,colModel:m[f]},f)}catch(b){h="textarea"===m[f].edittype?a(this).text():a(this).html()}switch(B.autoEncodeOnEdit&&(h=d.oldDecodePostedData(h)),(I.checkOnSubmit===!0||I.checkOnUpdate)&&(I._savedData[g]=h),g="#"+e(g),m[f].edittype){case"password":case"text":case"button":case"image":case"textarea":p(h)&&(h=""),a(g,c).val(h);break;case"select":var i=h.split(",");i=a.map(i,function(b){return a.trim(b)}),a(g+" option",c).each(function(){var b=this,c=a(b),d=a.trim(c.val()),e=a.trim(c.text());m[f].editoptions.multiple||a.trim(h)!==e&&i[0]!==e&&i[0]!==d?m[f].editoptions.multiple&&(a.inArray(e,i)>-1||a.inArray(d,i)>-1)?b.selected=!0:b.selected=!1:b.selected=!0});break;case"checkbox":h=String(h),m[f].editoptions&&m[f].editoptions.value?h=m[f].editoptions.value.split(":")[0]===h:(h=h.toLowerCase(),h=h.search(/(false|f|0|no|n|off|undefined)/i)<0&&""!==h),a(g,c).prop({checked:h,defaultChecked:h});break;case"custom":try{if(!m[f].editoptions||!a.isFunction(m[f].editoptions.custom_value))throw"e1";m[f].editoptions.custom_value.call(z,a(g,c),"set",h)}catch(a){"e1"===a?d.info_dialog.call(z,X,"function 'custom_value' "+I.msg.nodefined,I.bClose):d.info_dialog.call(z,X,a.message,I.bClose)}}l++}}),l>0&&a("#id_g",M).val(b))}function s(){var b=I.url||B.editurl;a.each(R,function(c,d){var e=d.name,f=C[e];"date"!==d.formatter||null!=d.formatoptions&&d.formatoptions.sendFormatted===!0||(C[e]=a.unformat.date.call(z,f,d)),"clientArray"!==b&&d.editoptions&&d.editoptions.NullIfEmpty===!0&&C.hasOwnProperty(e)&&""===f&&(C[e]="null")})}function t(){var c,e,g,h,i,j,k,l,m=[!0,"",""],n=m,o={},p=B.prmNames,q=f.getInd.call(A,b),t=q===!1?null:z.rows[q],u=A.triggerHandler("jqGridAddEditBeforeCheckValues",[C,a(J),E]);u&&"object"==typeof u&&(C=u),q=q===!1?-1:q,a.isFunction(I.beforeCheckValues)&&(u=I.beforeCheckValues.call(z,C,a(J),E),u&&"object"==typeof u&&(C=u));for(g in C)if(C.hasOwnProperty(g)&&(l=B.iColByName[g],n=d.checkValues.call(z,C[g],g,void 0,void 0,{oldValue:"_empty"===b?null:f.getCell.call(A,b,l),newValue:C[g],cmName:g,rowid:b,cm:R[l],iCol:l,iRow:q,tr:t,td:null==t?null:t.cells[l],mode:"_empty"===b?"addForm":"editForm"}),null!=n&&n!==!0||(n=m),n[0]===!1))break;if(s(),n[0]&&(o=A.triggerHandler("jqGridAddEditClickSubmit",[I,C,E]),void 0===o&&a.isFunction(I.onclickSubmit)&&(o=I.onclickSubmit.call(z,I,C,E)||{}),n=A.triggerHandler("jqGridAddEditBeforeSubmit",[C,a(J),E]),null!=n&&n!==!0||(n=m),n[0]&&a.isFunction(I.beforeSubmit)&&(n=I.beforeSubmit.call(z,C,a(J),E),null!=n&&n!==!0||(n=m))),n[0]&&!I.processing){if(I.processing=!0,a("#sData",N).addClass(aa),j=I.url||B.editurl,e=p.oper,c="clientArray"===j&&B.keyName!==!1?B.keyName:p.id,C[e]="_empty"===a.trim(C[F+"_id"])?p.addoper:p.editoper,C[e]!==p.addoper?C[c]=C[F+"_id"]:void 0===C[c]&&(C[c]=C[F+"_id"]),delete C[F+"_id"],C=a.extend(C,I.editData,o),B.treeGrid===!0){if(C[e]===p.addoper){h=B.selrow;var v="adjacency"===B.treeGridModel?B.treeReader.parent_id_field:"parent_id";C[v]=h}for(i in B.treeReader)if(B.treeReader.hasOwnProperty(i)&&(k=B.treeReader[i],C.hasOwnProperty(k))){if(C[e]===p.addoper&&"parent_id_field"===i)continue;delete C[k]}}C[c]=d.stripPref(B.idPrefix,C[c]),B.autoEncodeOnEdit&&a.each(C,function(b,c){a.isFunction(c)||(C[b]=d.oldEncodePostedData(c))});var w=a.extend({url:a.isFunction(j)?j.call(z,C[c],E,C,I):j,type:a.isFunction(I.mtype)?I.mtype.call(z,E,I,C[c],C):I.mtype,data:d.serializeFeedback.call(z,a.isFunction(I.serializeEditData)?I.serializeEditData:B.serializeEditData,"jqGridAddEditSerializeEditData",C),complete:function(b,g){if(A.jqGrid("progressBar",{method:"hide",loadtype:I.saveui}),a("#sData",N).removeClass(aa),C[c]=a("#id_g",M).val(),b.status>=300&&304!==b.status||0===b.status&&4===b.readyState?(n[0]=!1,n[1]=A.triggerHandler("jqGridAddEditErrorTextFormat",[b,E]),a.isFunction(I.errorTextFormat)?n[1]=I.errorTextFormat.call(z,b,E):n[1]=g+" Status: '"+b.statusText+"'. Error code: "+b.status):(n=A.triggerHandler("jqGridAddEditAfterSubmit",[b,C,E]),null!=n&&n!==!0||(n=m),n[0]&&a.isFunction(I.afterSubmit)&&(n=I.afterSubmit.call(z,b,C,E),null!=n&&n!==!0||(n=m))),n[0]===!1)a("#FormError>td",M).html(n[1]),a("#FormError",M).show();else{B.autoEncodeOnEdit&&a.each(C,function(a,b){C[a]=d.oldDecodePostedData(b)});var i=[a.extend({},I.reloadGridOptions||{})];if(C[e]===p.addoper?(n[2]||(n[2]=d.randId()),null==C[c]||"_empty"===C[c]||C[e]===p.addoper?C[c]=n[2]:n[2]=C[c],I.reloadAfterSubmit?A.trigger("reloadGrid",i):B.treeGrid===!0?f.addChildNode.call(A,n[2],h,C):f.addRowData.call(A,n[2],C,I.addedrow),I.closeAfterAdd?(B.treeGrid!==!0&&H.call(A,n[2]),W()):I.clearAfterAdd&&r("_empty",J)):(I.reloadAfterSubmit?(A.trigger("reloadGrid",i),I.closeAfterEdit||setTimeout(function(){H.call(A,C[c])},1e3)):B.treeGrid===!0?f.setTreeRow.call(A,C[c],C):f.setRowData.call(A,C[c],C),I.closeAfterEdit&&W()),a.isFunction(I.afterComplete)){var j=b;setTimeout(function(){A.triggerHandler("jqGridAddEditAfterComplete",[j,C,a(J),E]),I.afterComplete.call(z,j,C,a(J),E),j=null},50)}if((I.checkOnSubmit||I.checkOnUpdate)&&(a(J).data("disabled",!1),"_empty"!==I._savedData[F+"_id"])){var k;for(k in I._savedData)I._savedData.hasOwnProperty(k)&&C[k]&&(I._savedData[k]=C[k])}}I.processing=!1;try{a(":input:visible",J).focus()}catch(a){}}},d.ajaxOptions,I.ajaxEditOptions);if(w.url||I.useDataProxy||(a.isFunction(B.dataProxy)?I.useDataProxy=!0:(n[0]=!1,n[1]+=" "+d.errors.nourl)),n[0])if(A.jqGrid("progressBar",{method:"show",loadtype:I.saveui,htmlcontent:I.savetext}),I.useDataProxy){var x=B.dataProxy.call(z,w,"set_"+F);void 0===x&&(x=[!0,""]),x[0]===!1?(n[0]=!1,n[1]=x[1]||"Error deleting the selected row!"):(w.data.oper===p.addoper&&I.closeAfterAdd&&W(),w.data.oper===p.editoper&&I.closeAfterEdit&&W())}else"clientArray"===w.url?(I.reloadAfterSubmit=!1,C=w.data,w.complete({status:200,statusText:""},"")):a.ajax(w)}n[0]===!1&&(a("#FormError>td",M).html(n[1]),a("#FormError",M).show())}function u(a,b){var c,d=!1;for(c in a)if(a.hasOwnProperty(c)&&String(a[c])!==String(b[c])){d=!0;break}return d}function v(){var b=!0;return a("#FormError",M).hide(),I.checkOnUpdate&&(C={},k(),D=u(C,I._savedData),D&&(a(J).data("disabled",!0),a(".confirm",P).show(),b=!1)),b}function w(){var c=d.detectRowEditing.call(z,b);if(null!=c)if("inlineEditing"===c.mode)f.restoreRow.call(A,b);else{var e=c.savedRow,g=z.rows[e.id];f.restoreCell.call(A,e.id,e.ic),a(g.cells[e.ic]).removeClass("edit-cell "+_),a(g).addClass(_).attr({"aria-selected":"true",tabindex:"0"})}}function x(b,c){var d=c[1].length-1;0===b?a("#pData",N).addClass($):void 0!==c[1][b-1]&&i(a("#"+e(c[1][b-1])),$)?a("#pData",N).addClass($):a("#pData",N).removeClass($),b===d?a("#nData",N).addClass($):void 0!==c[1][b+1]&&i(a("#"+e(c[1][b+1])),$)?a("#nData",N).addClass($):a("#nData",N).removeClass($)}function y(){var b=f.getDataIDs.call(A),c=a("#id_g",M).val(),d=a.inArray(c,b);return[d,b]}var z=this,A=a(z),B=z.p;if(z.grid&&null!=B&&b){var C,D,E,F=B.id,G=f.getGridRes,H=f.setSelection,I=a.extend(!0,{top:0,left:0,width:300,datawidth:"auto",height:"auto",dataheight:"auto",drag:!0,resize:!0,url:null,mtype:"POST",clearAfterAdd:!0,closeAfterEdit:!1,reloadAfterSubmit:!0,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},closeOnEscape:!1,addedrow:"first",topinfo:"",bottominfo:"",savekey:[!1,13],navkeys:[!1,38,40],checkOnSubmit:!1,checkOnUpdate:!1,_savedData:{},processing:!1,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:!0,overlayClass:g.call(this,"overlay"),removemodal:!0,skipPostTypes:["image","file"],saveui:"enable",savetext:G.call(A,"defaults.savetext")||"Saving..."},G.call(A,"edit"),d.edit,B.formEditing||{},c||{}),J="FrmGrid_"+F,K=J,L="TblGrid_"+F,M="#"+e(L),N=M+"_2",O={themodal:"editmod"+F,modalhead:"edithd"+F,modalcontent:"editcnt"+F,resizeAlso:J},P="#"+e(O.themodal),Q=B.gBox,R=B.colModel,S=B.iColByName,T=1,U=0,V=I.commonIconClass,W=function(){d.hideModal(P,{gb:Q,jqm:I.jqModal,onClose:I.onClose,removemodal:I.removemodal})},X=G.call(A,"errors.errcap"),Y=function(){var b=a.makeArray(arguments);return b.unshift(""),b.unshift("AddEdit"),b.unshift(I),j.apply(z,b)},Z=n.call(z,"hover"),$=n.call(z,"disabled"),_=n.call(z,"select"),aa=n.call(z,"active"),ba=n.call(z,"error");a(P).remove(),J="#"+e(J),"new"===b?(b="_empty",E="add",I.caption=I.addCaption):(I.caption=I.editCaption,E="edit");var ca=!0;!I.checkOnUpdate||I.jqModal!==!0&&void 0!==I.jqModal||I.modal||(ca=!1);var da=isNaN(I.dataheight)?I.dataheight:I.dataheight+"px",ea=isNaN(I.datawidth)?I.datawidth:I.datawidth+"px",fa=a("<form name='FormPost' id='"+K+"' class='FormGrid' onSubmit='return false;' style='width:"+ea+";overflow:auto;position:relative;height:"+da+";'></form>").data("disabled",!1),ga=a("<table id='"+L+"' class='EditTable'><tbody></tbody></table>");a(R).each(function(){var a=this.formoptions;T=Math.max(T,a?a.colpos||0:0),U=Math.max(U,a?a.rowpos||0:0)}),a(fa).append(ga);var ha=a("<tr id='FormError' style='display:none'><td class='"+ba+"' colspan='"+2*T+"'>&#160;</td></tr>");if(ha[0].rp=0,a(ga).append(ha),ha=a("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+2*T+"'>"+(I.topinfo||"&#160;")+"</td></tr>"),ha[0].rp=0,a(ga).append(ha),Y("beforeInitData",fa,E)){w();var ia="rtl"===B.direction,ja=ia?"nData":"pData",ka=ia?"pData":"nData";q(b,ga,T);var la=l.call(z,ja,"",h(V,I.prevIcon),"","left"),ma=l.call(z,ka,"",h(V,I.nextIcon),"","right"),na=l.call(z,"sData",I.bSubmit),oa=l.call(z,"cData",I.bCancel),pa="<div class='"+g.call(z,"dialog.footer")+"'><table class='EditTable' id='"+L+"_2'><tbody><tr><td colspan='2'><hr class='"+g.call(z,"dialog.hr")+"' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton navButton-"+B.direction+"'>"+(ia?ma+la:la+ma)+"</td><td class='EditButton EditButton-"+B.direction+"'>"+na+"&#160;"+oa+"</td></tr>";if(pa+="<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+(I.bottominfo||"&#160;")+"</td></tr>",pa+="</tbody></table></div>",U>0){var qa=[];a.each(a(ga)[0].rows,function(a,b){qa[a]=b}),qa.sort(function(a,b){return a.rp>b.rp?1:a.rp<b.rp?-1:0}),a.each(qa,function(b,c){a("tbody",ga).append(c)})}I.gbox=Q;var ra=!1;I.closeOnEscape===!0&&(I.closeOnEscape=!1,ra=!0);var sa=a("<div></div>").append(a("<div class='"+g.call(z,"dialog.body")+"'></div>").append(fa)).append(pa);if(d.createModal.call(z,O,sa,I,B.gView,a(Q)[0]),I.topinfo&&a(".tinfo",M).show(),I.bottominfo&&a(".binfo",N).show(),sa=null,pa=null,a(P).keydown(function(b){var c,d,e=(b.target.tagName||"").toUpperCase();if(a(J).data("disabled")===!0)return!1;if(13===b.which&&"TEXTAREA"!==e){if(c=a(N).find(":focus"),d=c.attr("id"),c.length>0&&a.inArray(d,["pData","nData","cData"])>=0)return c.trigger("click"),!1;if(I.savekey[0]===!0&&13===I.savekey[1])return a("#sData",N).trigger("click"),!1}if(I.savekey[0]===!0&&b.which===I.savekey[1]&&"TEXTAREA"!==e)return a("#sData",N).trigger("click"),!1;if(27===b.which)return!!v()&&(ra&&W(),!1);if(I.navkeys[0]===!0){if("_empty"===a("#id_g",M).val())return!0;if(b.which===I.navkeys[1])return a("#pData",N).trigger("click"),!1;if(b.which===I.navkeys[2])return a("#nData",N).trigger("click"),!1}}),I.checkOnUpdate&&(a("a.ui-jqdialog-titlebar-close span",P).removeClass("jqmClose"),a("a.ui-jqdialog-titlebar-close",P).off("click").click(function(){return!!v()&&(W(),!1)})),m(a("#sData",N),I.saveicon,V),m(a("#cData",N),I.closeicon,V),I.checkOnSubmit||I.checkOnUpdate){na=l.call(z,"sNew",I.bYes),ma=l.call(z,"nNew",I.bNo),oa=l.call(z,"cNew",I.bExit);var ta=I.zIndex||999;ta++,a("<div class='"+I.overlayClass+" jqgrid-overlay confirm' style='z-index:"+ta+";display:none;'>&#160;</div><div class='"+g.call(z,"dialog.content","confirm ui-jqconfirm")+"' style='z-index:"+(ta+1)+"'>"+I.saveData+"<br/><br/>"+na+ma+oa+"</div>").insertAfter(J),a("#sNew",P).click(function(){return t(),a(J).data("disabled",!1),a(".confirm",P).hide(),!1}),a("#nNew",P).click(function(){return a(".confirm",P).hide(),a(J).data("disabled",!1),setTimeout(function(){a(":input:visible",J).focus()},0),!1}),a("#cNew",P).click(function(){return a(".confirm",P).hide(),a(J).data("disabled",!1),W(),!1})}Y("onInitializeForm",a(J),E),"_empty"!==b&&I.viewPagerButtons?a("#pData,#nData",N).show():a("#pData,#nData",N).hide(),Y("beforeShowForm",a(J),E),a(P).data("onClose",I.onClose),d.viewModal.call(z,P,{gbox:Q,jqm:I.jqModal,overlay:I.overlay,modal:I.modal,overlayClass:I.overlayClass,toTop:I.toTop,onHide:function(a){a.w.remove(),a.o&&a.o.remove()}}),ca||a("."+e(I.overlayClass)).click(function(){return!!v()&&(W(),!1)}),a(".fm-button",P).hover(function(){a(this).addClass(Z)},function(){a(this).removeClass(Z)}),a("#sData",N).click(function(){return C={},a("#FormError",M).hide(),k(),"_empty"===C[F+"_id"]?t():I.checkOnSubmit===!0?(D=u(C,I._savedData),D?(a(J).data("disabled",!0),a(".confirm",P).show()):t()):t(),!1}),a("#cData",N).click(function(){return!!v()&&(W(),!1)}),a("#nData",N).click(function(){if(!v())return!1;a("#FormError",M).hide();var b=y();if(b[0]=parseInt(b[0],10),b[0]!==-1&&b[1][b[0]+1]){if(!Y("onclickPgButtons","next",a(J),b[1][b[0]]))return!1;r(b[1][b[0]+1],J),H.call(A,b[1][b[0]+1]),Y("afterclickPgButtons","next",a(J),b[1][b[0]+1]),x(b[0]+1,b)}return!1}),a("#pData",N).click(function(){if(!v())return!1;a("#FormError",M).hide();var b=y();if(b[0]!==-1&&b[1][b[0]-1]){if(!Y("onclickPgButtons","prev",a(J),b[1][b[0]]))return!1;if(i(a("#"+e(b[1][b[0]-1])),$))return!1;r(b[1][b[0]-1],J),H.call(A,b[1][b[0]-1]),Y("afterclickPgButtons","prev",a(J),b[1][b[0]-1]),x(b[0]-1,b)}return!1}),Y("afterShowForm",a(J),E);var ua=y();x(ua[0],ua)}}})},viewGridRow:function(b,c){return this.each(function(){function k(){y.closeOnEscape!==!0&&y.navkeys[0]!==!0||setTimeout(function(){a("#cData").focus()},0)}function q(b,c,e){var h,i,j,k,l,m,n,q,r=0,s=[],t=f.getInd.call(v,b),x=g.call(u,"dialog.viewData"),z=a(c),A=g.call(u,"dialog.viewLabel"),B=String(y.labelswidth)+(!y.labelswidth||isNaN(y.labelswidth)?"":"px"),C="<td class='"+g.call(u,"dialog.viewCellLabel","CaptionTD form-view-label")+(B?"' style='width:"+B+";":"")+"'>&#160;</td><td class='"+g.call(u,"dialog.viewCellData","DataTD form-view-data")+"'>&#160;</td>",D="",E=["integer","number","currency"],F=0,G=0;for(l=0;l<e;l++)D+=C;if(a(I).each(function(){var b=this;i=(!b.editrules||b.editrules.edithidden!==!0)&&b.hidden===!0,i||"right"!==b.align||(b.formatter&&a.inArray(b.formatter,E)!==-1?F=Math.max(F,parseInt(b.width,10)):G=Math.max(G,parseInt(b.width,10)))}),m=0!==F?F:0!==G?G:0,a(I).each(function(b){var c=this;if(h=c.name,n=!1,i=(!c.editrules||c.editrules.edithidden!==!0)&&c.hidden===!0,q="boolean"!=typeof c.viewable||c.viewable,"cb"!==h&&"subgrid"!==h&&"rn"!==h&&q){k=t===!1?"":d.getDataFieldOfCell.call(u,u.rows[t],b).html(),n="right"===c.align&&0!==m;var f=a.extend({},{rowabove:!1,rowcontent:""},c.formoptions||{}),g=parseInt(f.rowpos,10)||r+1,l=parseInt(2*(parseInt(f.colpos,10)||1),10);if(f.rowabove){var o=a("<tr><td class='contentinfo' colspan='"+2*e+"'>"+f.rowcontent+"</td></tr>");z.append(o),o[0].rp=g}j=z.find("tr[data-rowpos="+g+"]"),0===j.length&&(j=a("<tr data-rowpos='"+g+"'></tr>").addClass("FormData").attr("id","trv_"+h),j.append(D),z.append(j),j[0].rp=g);var v=void 0===f.label?w.colNames[b]:f.label,y=a("td:eq("+(l-1)+")",j[0]),B=a("td:eq("+(l-2)+")",j[0]);B.html("<label for='"+h+"'"+(A?" class='"+A+"'>":">")+(v||"&nbsp;")+"</label>"),y[p(y.html())?"html":"append"]("<span id='"+h+"'"+(x?" class='"+x+"'>":">")+(k||"&nbsp;")+"</span>").attr("id","v_"+h),n&&a("td:eq("+(l-1)+") span",j[0]).css({"text-align":"right",width:m+"px"}),i&&B.add(y).css("visibility","hidden"),s[r]=b,r++}}),o(z),r>0){var H=a("<tr class='FormData' style='display:none'><td class='CaptionTD'>&#160;</td><td colspan='"+(2*e-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+b+"'/></td></tr>");H[0].rp=r+99,z.append(H)}return s}function r(b){var c,g,h=0,i=f.getInd.call(v,b,!0);i&&(a("td",i).each(function(b){g=I[b],c=g.name,"cb"!==c&&"subgrid"!==c&&"rn"!==c&&(c=e("v_"+c),a("#"+c+" span",A).html(d.getDataFieldOfCell.call(u,i,b).html()),h++)}),h>0&&a("#id_g",A).val(b))}function s(b,c){var d=c[1].length-1;0===b?a("#pData",B).addClass(O):void 0!==c[1][b-1]&&i(a("#"+e(c[1][b-1])),O)?a("#pData",B).addClass(O):a("#pData",B).removeClass(O),b===d?a("#nData",B).addClass(O):void 0!==c[1][b+1]&&i(a("#"+e(c[1][b+1])),O)?a("#nData",B).addClass(O):a("#nData",B).removeClass(O)}function t(){var b=f.getDataIDs.call(v),c=a("#id_g",A).val(),d=a.inArray(c,b);return[d,b]}var u=this,v=a(u),w=u.p;if(u.grid&&null!=w&&b){var x=w.id,y=a.extend(!0,{top:0,left:0,width:0,datawidth:"auto",height:"auto",dataheight:"auto",drag:!0,resize:!0,closeOnEscape:!1,labelswidth:"",navkeys:[!1,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:!0,removemodal:!0},f.getGridRes.call(v,"view"),d.view||{},w.formViewing||{},c||{}),z="#ViewGrid_"+e(x),A="#ViewTbl_"+e(x),B=A+"_2",C="ViewGrid_"+x,D="ViewTbl_"+x,E=y.commonIconClass,F={themodal:"viewmod"+x,modalhead:"viewhd"+x,modalcontent:"viewcnt"+x,resizeAlso:C},G="#"+e(F.themodal),H=w.gBox,I=w.colModel,J=1,K=0,L=function(){var b=a.makeArray(arguments);return b.unshift(""),b.unshift("View"),b.unshift(y),j.apply(u,b)},M=function(){d.hideModal(G,{gb:H,jqm:y.jqModal,onClose:y.onClose,removemodal:y.removemodal})},N=n.call(u,"hover"),O=n.call(u,"disabled"),P=isNaN(y.dataheight)?y.dataheight:y.dataheight+"px",Q=isNaN(y.datawidth)?y.datawidth:y.datawidth+"px",R=a("<div class='"+g.call(u,"dialog.body")+"'><form name='FormPost' id='"+C+"' class='FormGrid' style='width:"+Q+";overflow:auto;position:relative;height:"+P+";'></form></div>"),S=R.children("form.FormGrid"),T=a("<table id='"+D+"' class='EditTable'><tbody></tbody></table>");if(a(G).remove(),a(I).each(function(){var a=this.formoptions;J=Math.max(J,a?a.colpos||0:0),K=Math.max(K,a?a.rowpos||0:0)}),S.append(T),L("beforeInitData",S)){q(b,T,J);var U="rtl"===w.direction,V=U?"nData":"pData",W=U?"pData":"nData",X=l.call(u,V,"",h(E,y.prevIcon),"","left"),Y=l.call(u,W,"",h(E,y.nextIcon),"","right"),Z=l.call(u,"cData",y.bClose);if(K>0){var $=[];a.each(a(T)[0].rows,function(a,b){$[a]=b}),$.sort(function(a,b){return a.rp>b.rp?1:a.rp<b.rp?-1:0}),a.each($,function(b,c){a("tbody",T).append(c)})}y.gbox=H;var _=a("<div></div>").append(R).append("<div class='"+g.call(u,"dialog.footer")+"'><table border='0' class='EditTable' id='"+D+"_2'><tbody><tr id='Act_Buttons'><td class='navButton navButton-"+w.direction+"' width='"+(y.labelswidth||"auto")+"'>"+(U?Y+X:X+Y)+"</td><td class='EditButton EditButton-"+w.direction+"'>"+Z+"</td></tr></tbody></table></div>");d.createModal.call(u,F,_,y,w.gView,a(w.gView)[0]),y.viewPagerButtons||a("#pData, #nData",B).hide(),_=null,a(G).keydown(function(b){var c,d;if(a(z).data("disabled")===!0)return!1;if(13===b.which&&(c=a(B).find(":focus"),d=c.attr("id"),c.length>0&&a.inArray(d,["pData","nData","cData"])>=0))return c.trigger("click"),!1;if(27===b.which)return y.closeOnEscape&&M(),!1;if(y.navkeys[0]===!0){if(b.which===y.navkeys[1])return a("#pData",B).trigger("click"),!1;if(b.which===y.navkeys[2])return a("#nData",B).trigger("click"),!1}}),m(a("#cData",B),y.closeicon,E),L("beforeShowForm",a(z)),d.viewModal.call(u,G,{gbox:H,jqm:y.jqModal,overlay:y.overlay,toTop:y.toTop,modal:y.modal,onHide:function(a){a.w.remove(),a.o&&a.o.remove()}}),a(".fm-button:not(."+O.split(" ").join(".")+")",B).hover(function(){a(this).addClass(N)},function(){a(this).removeClass(N)}),k(),a("#cData",B).click(function(){return M(),!1}),a("#nData",B).click(function(){a("#FormError",A).hide();var b=t();
if(b[0]=parseInt(b[0],10),b[0]!==-1&&b[1][b[0]+1]){if(!L("onclickPgButtons","next",a(z),b[1][b[0]]))return!1;r(b[1][b[0]+1]),f.setSelection.call(v,b[1][b[0]+1]),L("afterclickPgButtons","next",a(z),b[1][b[0]+1]),s(b[0]+1,b)}return k(),!1}),a("#pData",B).click(function(){a("#FormError",A).hide();var b=t();if(b[0]!==-1&&b[1][b[0]-1]){if(!L("onclickPgButtons","prev",a(z),b[1][b[0]]))return!1;r(b[1][b[0]-1]),f.setSelection.call(v,b[1][b[0]-1]),L("afterclickPgButtons","prev",a(z),b[1][b[0]-1]),s(b[0]-1,b)}return k(),!1});var aa=t();s(aa[0],aa)}}})},delGridRow:function(b,c){return this.each(function(){var h=this,i=h.p,k=a(h);if(h.grid&&null!=i&&b){var o,p,q,r,s=i.id,t=a.extend(!0,{top:0,left:0,width:240,removemodal:!0,height:"auto",dataheight:"auto",datawidth:"auto",drag:!0,resize:!0,url:"",mtype:"POST",reloadAfterSubmit:!0,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,closeOnEscape:!1,delData:{},onClose:null,ajaxDelOptions:{},processing:!1,serializeDelData:null,useDataProxy:!1},f.getGridRes.call(k,"del"),d.del||{},i.formDeleting||{},c||{}),u="DelTbl_"+s,v="#DelTbl_"+e(s),w={themodal:"delmod"+s,modalhead:"delhd"+s,modalcontent:"delcnt"+s,resizeAlso:u},x="#"+e(w.themodal),y=i.gBox,z=t.commonIconClass,A=function(){var b=a.makeArray(arguments);return b.unshift(""),b.unshift("Delete"),b.unshift(t),j.apply(h,b)},B=n.call(h,"hover"),C=n.call(h,"active"),D=n.call(h,"error");if(a.isArray(b)||(b=[String(b)]),void 0!==a(x)[0]){if(!A("beforeInitData",a(v)))return;a("#DelData>td",v).text(b.join()).data("rowids",b),a("#DelError",v).hide(),t.processing===!0&&(t.processing=!1,a("#dData",v).removeClass(C)),A("beforeShowForm",a(v)),d.viewModal.call(h,x,{gbox:y,jqm:t.jqModal,jqM:!1,overlay:t.overlay,toTop:t.toTop,modal:t.modal}),A("afterShowForm",a(v))}else{var E=isNaN(t.dataheight)?t.dataheight:t.dataheight+"px",F=isNaN(t.datawidth)?t.datawidth:t.datawidth+"px",G="<div class='"+g.call(h,"dialog.body")+"'><div id='"+u+"' class='formdata' style='width:"+F+";overflow:auto;position:relative;height:"+E+";'>";G+="<table class='DelTable'><tbody>",G+="<tr id='DelError' style='display:none'><td class='"+D+"'></td></tr>",G+="<tr id='DelData' style='display:none'><td >"+b.join()+"</td></tr>",G+="<tr><td class='delmsg'>"+t.msg+"</td></tr>",G+="</tbody></table></div></div>";var H=l.call(h,"dData",t.bSubmit),I=l.call(h,"eData",t.bCancel);if(G+="<div class='"+g.call(h,"dialog.footer")+"'><table class='EditTable' id='"+u+"_2'><tbody><tr><td><hr class='"+g.call(h,"dialog.hr")+"' style='margin:1px'/></td></tr><tr><td class='DelButton EditButton EditButton-"+i.direction+"'>"+H+"&#160;"+I+"</td></tr></tbody></table></div>",t.gbox=y,d.createModal.call(h,w,G,t,i.gView,a(i.gView)[0]),a("#DelData>td",v).data("rowids",b),!A("beforeInitData",a(G)))return;a(".fm-button",v+"_2").hover(function(){a(this).addClass(B)},function(){a(this).removeClass(B)}),m(a("#dData",v+"_2"),t.delicon,z),m(a("#eData",v+"_2"),t.cancelicon,z),a("#dData",v+"_2").click(function(){var b,c=[!0,""],e=a("#DelData>td",v),g=e.text(),j=e.data("rowids"),l={};if(a.isFunction(t.onclickSubmit)&&(l=t.onclickSubmit.call(h,t,g)||{}),a.isFunction(t.beforeSubmit)&&(c=t.beforeSubmit.call(h,g)||c),c[0]&&!t.processing){if(t.processing=!0,q=i.prmNames,o=a.extend({},t.delData,l),r=q.oper,o[r]=q.deloper,p=q.id,g=j.slice(),!g.length)return!1;for(b in g)g.hasOwnProperty(b)&&(g[b]=d.stripPref(i.idPrefix,g[b]));o[p]=g.join(),a(this).addClass(C);var m=t.url||i.editurl,n=a.extend({url:a.isFunction(m)?m.call(h,o[p],o,t):m,type:t.mtype,data:a.isFunction(t.serializeDelData)?t.serializeDelData.call(h,o):o,complete:function(b,e){var l;if(a("#dData",v+"_2").removeClass(C),b.status>=300&&304!==b.status||0===b.status&&4===b.readyState?(c[0]=!1,a.isFunction(t.errorTextFormat)?c[1]=t.errorTextFormat.call(h,b):c[1]=e+" Status: '"+b.statusText+"'. Error code: "+b.status):a.isFunction(t.afterSubmit)&&(c=t.afterSubmit.call(h,b,o)||[!0]),c[0]===!1)a("#DelError>td",v).html(c[1]),a("#DelError",v).show();else{if("local"===i.datatype||i.treeGrid===!0||!t.reloadAfterSubmit)if(i.treeGrid===!0)try{f.delTreeNode.call(k,j[0])}catch(a){}else for(j=j.slice(),l=0;l<j.length;l++)f.delRowData.call(k,j[l]);t.reloadAfterSubmit&&k.trigger("reloadGrid",[a.extend({},t.reloadGridOptions||{})]),setTimeout(function(){A("afterComplete",b,g,a(v))},50)}t.processing=!1,c[0]&&d.hideModal(x,{gb:y,jqm:t.jqModal,onClose:t.onClose,removemodal:t.removemodal})}},d.ajaxOptions,t.ajaxDelOptions);if(n.url||t.useDataProxy||(a.isFunction(i.dataProxy)?t.useDataProxy=!0:(c[0]=!1,c[1]+=" "+d.errors.nourl)),c[0])if(t.useDataProxy){var u=i.dataProxy.call(h,n,"del_"+s);void 0===u&&(u=[!0,""]),u[0]===!1?(c[0]=!1,c[1]=u[1]||"Error deleting the selected row!"):d.hideModal(x,{gb:y,jqm:t.jqModal,onClose:t.onClose,removemodal:t.removemodal})}else"clientArray"===n.url?(o=n.data,n.complete({status:200,statusText:""},"")):a.ajax(n)}return c[0]===!1&&(a("#DelError>td",v).html(c[1]),a("#DelError",v).show()),!1}),a("#eData",v+"_2").click(function(){return d.hideModal(x,{gb:y,jqm:t.jqModal,onClose:t.onClose,removemodal:t.removemodal}),!1}),A("beforeShowForm",a(v)),d.viewModal.call(h,x,{gbox:y,jqm:t.jqModal,overlay:t.overlay,toTop:t.toTop,modal:t.modal}),A("afterShowForm",a(v))}t.closeOnEscape===!0&&setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+e(w.modalhead)).attr("tabindex","-1").focus()},0)}})},navGrid:function(j,k,l,m,o,p,q){return"object"==typeof j&&(q=p,p=o,o=m,m=l,l=k,k=j,j=void 0),m=m||{},l=l||{},q=q||{},o=o||{},p=p||{},this.each(function(){var r=this,s=r.p,t=a(r);if(r.grid&&null!=s&&!(r.nav&&a(j).find(".navtable").length>0)){var u=s.id,v=a.extend({edit:!0,add:!0,del:!0,search:!0,refresh:!0,refreshstate:"firstpage",view:!1,closeOnEscape:!0,beforeRefresh:null,afterRefresh:null,cloneToTop:!1,hideEmptyPagerParts:!0,alertwidth:200,alertheight:"auto",alerttop:null,removemodal:!0,alertleft:null,alertzIndex:null,iconsOverText:!1},f.getGridRes.call(t,"nav"),d.nav||{},s.navOptions||{},k||{});v.position=v.position||("rtl"===s.direction?"right":"left");var w,x,y,z=s.idSel,A=s.gBox,B=v.commonIconClass,C={themodal:"alertmod_"+u,modalhead:"alerthd_"+u,modalcontent:"alertcnt_"+u},D=function(){return function(){var f=c.documentElement,h=b,i=1024,j=768,k=t.closest(".ui-jqgrid").offset();void 0===a("#"+e(C.themodal))[0]&&(v.alerttop||v.alertleft||(void 0!==h.innerWidth?(i=h.innerWidth,j=h.innerHeight):null!=f&&void 0!==f.clientWidth&&0!==f.clientWidth&&(i=f.clientWidth,j=f.clientHeight),i=i/2-parseInt(v.alertwidth,10)/2-k.left,j=j/2-25-k.top),d.createModal.call(r,C,"<div class='"+g.call(r,"dialog.body")+"'><div>"+v.alerttext+"</div></div>",{gbox:A,jqModal:v.jqModal,drag:!0,resize:!0,caption:v.alertcap,top:null!=v.alerttop?v.alerttop:j,left:null!=v.alertleft?v.alertleft:i,width:v.alertwidth,height:v.alertheight,closeOnEscape:v.closeOnEscape,zIndex:v.alertzIndex,removemodal:v.removemodal},s.gView,a(A)[0],!1)),d.viewModal.call(r,"#"+e(C.themodal),{gbox:A,toTop:v.alertToTop,jqm:v.jqModal});var l=a("#"+e(C.modalhead)).find(".ui-jqdialog-titlebar-close");l.attr({tabindex:"0",href:"#",role:"button"}),setTimeout(function(){l.focus()},50)}},E=D(),F=function(b){var c;if(13===b.which&&(c=a(this).find(".ui-pg-button").filter(":focus"),c.length>0)){var d=c[0].id,e=d.substr(0,a(this).closest(".ui-jqgrid-toppager").length>0?d.length-u.length-5:d.length-u.length-1),f=e+"mod"+s.id,g=a(".ui-jqdialog").filter(":visible").map(function(){return this.id});if(a.inArray(f,g)<0)return c.trigger("click"),!1}},G=n.call(r,"hover"),H=n.call(r,"disabled"),I=g.call(r,"navButton","ui-pg-button");if(r.grid){r.modalAlert=E,void 0===j&&(s.pager?(j=s.pager,s.toppager&&(v.cloneToTop=!0)):s.toppager&&(j=s.toppager));var J,K,L,M,N,O,P,Q=1,R=["left","center","right"],S=g.call(r,"navButton","ui-pg-button "+n.call(r,"disabled")),T="<div class='"+S+"'><span class='ui-separator'></span></div>",U=function(){i(this,H)||a(this).addClass(G)},V=function(){a(this).removeClass(G)},W=function(){return i(this,H)||(a.isFunction(v.addfunc)?v.addfunc.call(r,m):f.editGridRow.call(t,"new",m)),!1},X=function(b,c,d){if(!i(this,H)){var e=s.selrow;e?a.isFunction(b)?b.call(r,e,d):f[c].call(t,e,d):E()}return!1},Y=function(){return X.call(this,v.editfunc,"editGridRow",l)},Z=function(){return X.call(this,v.viewfunc,"viewGridRow",q)},$=function(){var b;return i(this,H)||(s.multiselect?(b=s.selarrrow,0===b.length&&(b=null)):b=s.selrow,b?a.isFunction(v.delfunc)?v.delfunc.call(r,b,o):f.delGridRow.call(t,b,o):E()),!1},_=function(){return i(this,H)||(a.isFunction(v.searchfunc)?v.searchfunc.call(r,p):f.searchGrid.call(t,p)),!1},aa=function(){if(!i(this,H)){a.isFunction(v.beforeRefresh)&&v.beforeRefresh.call(r),s.search=!1,s.resetsearch=!0;try{if("currentfilter"!==v.refreshstate){s.postData.filters="";try{a("#fbox_"+z).jqFilter("resetFilter")}catch(a){}a.isFunction(r.clearToolbar)&&r.clearToolbar(!1)}}catch(a){}switch(v.refreshstate){case"firstpage":t.trigger("reloadGrid",[a.extend({},v.reloadGridOptions||{},{page:1})]);break;case"current":case"currentfilter":t.trigger("reloadGrid",[a.extend({},v.reloadGridOptions||{},{current:!0})])}a.isFunction(v.afterRefresh)&&v.afterRefresh.call(r)}return!1},ba=function(b,c,d){var e=a("<div class='"+I+"' tabindex='0' role='button'></div>"),f=v[b+"icon"],g=a.trim(v[b+"text"]);return e.append("<div class='ui-pg-div'><span class='"+(v.iconsOverText?h("ui-pg-button-icon-over-text",B,f):h(B,f))+"'></span>"+(g?"<span class='ui-pg-button-text"+(v.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+g+"</span>":"")+"</div>"),a(y).append(e),e.attr({title:v[b+"title"]||"",id:c||b+"_"+M}).click(d).hover(U,V),e};for(v.cloneToTop&&s.toppager&&(Q=2),J=0;J<Q;J++){if(y=a("<div class='ui-pg-table navtable' role='toolbar' style='float:"+("rtl"===s.direction?"right":"left")+";table-layout:auto;'></div>"),0===J?(L=j,M=u,L===s.toppager&&(M+="_top",Q=1)):(L=s.toppager,M=u+"_top"),v.add&&ba("add",m.id,W),v.edit&&ba("edit",l.id,Y),v.view&&ba("view",q.id,Z),v.del&&ba("del",o.id,$),(v.add||v.edit||v.del||v.view)&&a(y).append(T),v.search&&(K=ba("search",p.id,_),p.showOnLoad&&p.showOnLoad===!0&&a(K,y).click()),v.refresh&&ba("refresh","",aa),x=a(".ui-jqgrid>.ui-jqgrid-view").css("font-size")||"11px",a("body").append("<div id='testpg2' class='"+g.call(r,"gBox","ui-jqgrid")+"' style='font-size:"+x+";visibility:hidden;' ></div>"),w=a(y).clone().appendTo("#testpg2").width(),a("#testpg2").remove(),a(L+"_"+v.position,L).append(y),v.hideEmptyPagerParts)for(N=0;N<R.length;N++)R[N]!==v.position&&(P=a(L+"_"+R[N],L),0===P.length||0===P[0].childNodes.length?P.hide():1===P[0].childNodes.length&&(O=P[0].firstChild,!a(O).is("table.ui-pg-table")||0!==O.rows&&0!==O.rows[0].cells.length||P.hide()));s._nvtd&&(w>s._nvtd[0]&&(a(L+"_"+v.position,L).width(w),s._nvtd[0]=w),s._nvtd[1]=w),r.nav=!0,y.on("keydown.jqGrid",F)}t.triggerHandler("jqGridResetFrozenHeights")}}})},navButtonAdd:function(b,c){return"object"==typeof b&&(c=b,b=void 0),this.each(function(){var j=this,k=j.p;if(j.grid){var l=a.extend({caption:"newButton",title:"",onClickButton:null,position:"last",iconsOverText:!1},f.getGridRes.call(a(j),"nav"),d.nav||{},k.navOptions||{},c||{}),m=l.id,o=n.call(j,"hover"),p=n.call(j,"disabled"),q=g.call(j,"navButton","ui-pg-button");if(void 0===b)if(k.pager){if(f.navButtonAdd.call(a(j),k.pager,l),!k.toppager)return;b=k.toppager,m&&(m+="_top")}else k.toppager&&(b=k.toppager);"string"==typeof b&&0!==b.indexOf("#")&&(b="#"+e(b));var r=a(".navtable",b),s=l.commonIconClass;if(r.length>0){if(m&&r.find("#"+e(m)).length>0)return;var t=a("<div tabindex='0' role='button'></div>");"NONE"===l.buttonicon.toString().toUpperCase()?a(t).addClass(q).append("<div class='ui-pg-div'>"+(l.caption?"<span class='ui-pg-button-text"+(l.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+l.caption+"</span>":"")+"</div>"):a(t).addClass(q).append("<div class='ui-pg-div'><span class='"+(l.iconsOverText?h("ui-pg-button-icon-over-text",s,l.buttonicon):h(s,l.buttonicon))+"'></span>"+(l.caption?"<span class='ui-pg-button-text"+(l.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+l.caption+"</span>":"")+"</div>"),m&&a(t).attr("id",m),"first"===l.position&&r.children("div.ui-pg-button").length>0?r.children("div.ui-pg-button").first().before(t):r.append(t),a(t,r).attr("title",l.title||"").click(function(b){return i(this,p)||a.isFunction(l.onClickButton)&&l.onClickButton.call(j,l,b),!1}).hover(function(){i(this,p)||a(this).addClass(o)},function(){a(this).removeClass(o)}),a(j).triggerHandler("jqGridResetFrozenHeights")}}})},navSeparatorAdd:function(b,c){return c=a.extend({sepclass:"ui-separator",sepcontent:"",position:"last"},c||{}),this.each(function(){if(this.grid){var d=this,h=d.p,i=g.call(d,"navButton","ui-pg-button "+n.call(d,"disabled"));if(void 0===b)if(h.pager){if(f.navSeparatorAdd.call(a(d),h.pager,c),!h.toppager)return;b=h.toppager}else h.toppager&&(b=h.toppager);"string"==typeof b&&0!==b.indexOf("#")&&(b="#"+e(b));var j=a(".navtable",b);if(j.length>0){var k="<div class='"+i+"'><span class='"+c.sepclass+"'></span>"+c.sepcontent+"</div>";"first"===c.position?0===j.children("div.ui-pg-button").length?j.append(k):j.children("div.ui-pg-button").first().before(k):j.append(k)}}})},GridToForm:function(b,c){return this.each(function(){var d,g,h,i,j=this;if(j.grid){var k=f.getRowData.call(a(j),b);if(k)for(d in k)if(k.hasOwnProperty(d))if(g=a("[name="+e(d)+"]",c),g.is("input:radio")||g.is("input:checkbox"))for(h=0;h<g.length;h++)i=a(g[h]),i.prop("checked",i.val()===String(k[d]));else g.val(p(k[d])?"":k[d])}})},FormToGrid:function(b,c,d,e){return this.each(function(){var g=this;if(g.grid){d||(d="set"),e||(e="first");var h=a(c).serializeArray(),i={};a.each(h,function(a,b){i[b.name]=b.value}),"add"===d?f.addRowData.call(a(g),b,i,e):"set"===d&&f.setRowData.call(a(g),b,i)}})}})});
//# sourceMappingURL=grid.formedit.js.map